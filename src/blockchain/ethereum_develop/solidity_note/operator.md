---
title: Solidity è¿ç®—ç¬¦å®Œæ•´æŒ‡å—
category:
  - ä»¥å¤ªåŠ
  - Solidity
---

# Solidity è¿ç®—ç¬¦å®Œæ•´æŒ‡å—

## ğŸ“‹ ç›®å½•
- [è¿ç®—ç¬¦åŸºç¡€è§„åˆ™](#è¿ç®—ç¬¦åŸºç¡€è§„åˆ™)
- [ä¸‰å…ƒè¿ç®—ç¬¦](#ä¸‰å…ƒè¿ç®—ç¬¦)
- [å¤åˆèµ‹å€¼ä¸å¢å‡è¿ç®—ç¬¦](#å¤åˆèµ‹å€¼ä¸å¢å‡è¿ç®—ç¬¦)
- [delete æ“ä½œç¬¦](#delete-æ“ä½œç¬¦)
- [å®æˆ˜ç¤ºä¾‹](#å®æˆ˜ç¤ºä¾‹)

---

## ğŸ”¹ è¿ç®—ç¬¦åŸºç¡€è§„åˆ™

### ç±»å‹è½¬æ¢ä¼˜å…ˆçº§
è¿ç®—æ—¶ï¼ŒSolidity æŒ‰ä»¥ä¸‹è§„åˆ™ç¡®å®šè¿ç®—ç±»å‹ï¼š

1. **å³æ“ä½œæ•°èƒ½éšå¼è½¬æ¢ä¸ºå·¦æ“ä½œæ•°ç±»å‹** â†’ æŒ‰å·¦æ“ä½œæ•°ç±»å‹è¿ç®—
2. **å·¦æ“ä½œæ•°èƒ½éšå¼è½¬æ¢ä¸ºå³æ“ä½œæ•°ç±»å‹** â†’ æŒ‰å³æ“ä½œæ•°ç±»å‹è¿ç®—  
3. **ä¸¤è€…äº’ç›¸éƒ½ä¸èƒ½éšå¼è½¬æ¢** â†’ âŒ ç¼–è¯‘é”™è¯¯

### å­—é¢å¸¸æ•°å¤„ç†
- **è‡ªåŠ¨ç±»å‹æ¨å¯¼**ï¼š`5` â†’ `uint8`ï¼Œ`-5` â†’ `int8`
- **æ— é™ç²¾åº¦**ï¼šä¸¤ä¸ªå­—é¢å¸¸æ•°è¿ç®—æ—¶ç²¾åº¦æ— é™ï¼Œä¸ä¼šæº¢å‡º
- **ä¼˜å…ˆçº§**ï¼šç›¸åŒä½å®½ä¸‹ï¼Œæ— ç¬¦å·ç±»å‹ä¼˜å…ˆçº§ < æœ‰ç¬¦å·ç±»å‹

### ç»“æœç±»å‹è§„åˆ™
- **ä¸€èˆ¬è¿ç®—**ï¼šç»“æœç±»å‹ = è¿ç®—æ‰€é‡‡ç”¨çš„ç±»å‹
- **æ¯”è¾ƒè¿ç®—**ï¼š`<`, `>`, `<=`, `>=`, `==`, `!=` ç»“æœå§‹ç»ˆæ˜¯ `bool`
- **ç‰¹æ®Šè¿ç®—**ï¼šå¹‚è¿ç®— `**`ã€ä½ç§» `<<`ã€`>>` ç»“æœä½¿ç”¨**å·¦æ“ä½œæ•°ç±»å‹**

### ç¤ºä¾‹
```solidity
uint8  x = 5;
int32  z = 10;
var y = x + z;      // int32 ç±»å‹ï¼ˆuint8 å¯è½¬ä¸º int32ï¼‰

uint256 a = 2;
uint8   b = 10;
var c = a ** b;     // uint256 ç±»å‹ï¼ˆå·¦æ“ä½œæ•°ç±»å‹ï¼‰

bool cmp = (x < z); // bool ç±»å‹
```

---

## ğŸ”¹ ä¸‰å…ƒè¿ç®—ç¬¦

### è¯­æ³•
```solidity
<æ¡ä»¶è¡¨è¾¾å¼> ? <trueè¡¨è¾¾å¼> : <falseè¡¨è¾¾å¼>
```

### æ ¸å¿ƒè§„åˆ™
- **ç±»å‹ç¡®å®š**ï¼šç»“æœç±»å‹ç”±ä¸¤ä¸ªåˆ†æ”¯è¡¨è¾¾å¼ç±»å‹å†³å®š
- **ä¸ä¿æŒæœ‰ç†æ•°ç±»å‹**ï¼šä¼šå¼ºåˆ¶è½¬æ¢ä¸ºå®é™…ç±»å‹
- **è½¬æ¢è§„åˆ™**ï¼šä¸æ™®é€šè¿ç®—ç¬¦ç›¸åŒ

### å…³é”®åŒºåˆ«
| æƒ…å†µ | ç¤ºä¾‹ | ç»“æœ |
|------|------|------|
| çº¯å­—é¢é‡è¡¨è¾¾å¼ | `1.5 + 1.5` | âœ… ä¿æŒæ— é™ç²¾åº¦ |
| ä¸‰å…ƒè¡¨è¾¾å¼å‚ä¸ | `1.5 + (true ? 1.5 : 2.5)` | âŒ å¯èƒ½ç¼–è¯‘é”™è¯¯ |

### ç¤ºä¾‹åˆ†æ

#### âŒ æº¢å‡ºé™·é˜±
```solidity
uint8 a = 255;
uint8 b = a + (true ? 1 : 0);  
// é”™è¯¯ï¼š(true ? 1 : 0) è¢«æ¨æ–­ä¸º uint8
// å¯¼è‡´ 255 + 1 = 256 æº¢å‡º uint8 èŒƒå›´
```

#### âŒ å°æ•°ç±»å‹é”™è¯¯
```solidity
var y = 1.5 + (true ? 1.5 : 2.5); 
// é”™è¯¯ï¼šæ— æ³•å°†å°æ•°å­—é¢é‡ä½œä¸ºæ•´æ•°ç±»å‹å¤„ç†
```

#### âœ… æ­£ç¡®ç”¨æ³•
```solidity
uint256 a = 10;
uint256 b = 20;
uint256 c = (a > b ? a : b);  // c = 20

uint8  m = 5;
int32  n = -3;
var r = (true ? m : n);       // r ç±»å‹ä¸º int32
```

---

## ğŸ”¹ å¤åˆèµ‹å€¼ä¸å¢å‡è¿ç®—ç¬¦

### å¤åˆèµ‹å€¼è¿ç®—ç¬¦
å¯¹äº LValue å˜é‡ `a`ï¼Œæ”¯æŒä»¥ä¸‹ç®€å†™å½¢å¼ï¼š

| è¿ç®—ç¬¦ | ç­‰ä»·å½¢å¼ | è¯´æ˜ |
|--------|----------|------|
| `a += e` | `a = a + e` | åŠ æ³•èµ‹å€¼ |
| `a -= e` | `a = a - e` | å‡æ³•èµ‹å€¼ |
| `a *= e` | `a = a * e` | ä¹˜æ³•èµ‹å€¼ |
| `a /= e` | `a = a / e` | é™¤æ³•èµ‹å€¼ |
| `a %= e` | `a = a % e` | å–æ¨¡èµ‹å€¼ |
| `a \|= e` | `a = a \| e` | æŒ‰ä½æˆ–èµ‹å€¼ |
| `a &= e` | `a = a & e` | æŒ‰ä½ä¸èµ‹å€¼ |
| `a ^= e` | `a = a ^ e` | æŒ‰ä½å¼‚æˆ–èµ‹å€¼ |
| `a <<= e` | `a = a << e` | å·¦ç§»èµ‹å€¼ |
| `a >>= e` | `a = a >> e` | å³ç§»èµ‹å€¼ |

### å¢å‡è¿ç®—ç¬¦

| è¿ç®—ç¬¦ | è¡Œä¸º | è¿”å›å€¼ |
|--------|------|--------|
| `a++` | åç½®é€’å¢ | ä¿®æ”¹å‰çš„æ—§å€¼ |
| `++a` | å‰ç½®é€’å¢ | ä¿®æ”¹åçš„æ–°å€¼ |
| `a--` | åç½®é€’å‡ | ä¿®æ”¹å‰çš„æ—§å€¼ |
| `--a` | å‰ç½®é€’å‡ | ä¿®æ”¹åçš„æ–°å€¼ |

```solidity
uint256 x = 5;
uint256 y = x++;  // y = 5, x = 6 (å…ˆè¿”å›å†ä¿®æ”¹)
uint256 z = ++x;  // z = 7, x = 7 (å…ˆä¿®æ”¹å†è¿”å›)
```

---

## ğŸ”¹ delete æ“ä½œç¬¦

### åŸºæœ¬æ¦‚å¿µ
`delete a` å°†å˜é‡ `a` é‡ç½®ä¸ºè¯¥ç±»å‹çš„**é»˜è®¤åˆå§‹å€¼**ã€‚

### ä¸åŒç±»å‹çš„ delete è¡Œä¸º

| ç±»å‹ | delete è¡Œä¸º | ç¤ºä¾‹ |
|------|-------------|------|
| **æ•´æ•°ç±»å‹** | é‡ç½®ä¸º `0` | `delete x` â†’ `x = 0` |
| **å¸ƒå°”ç±»å‹** | é‡ç½®ä¸º `false` | `delete flag` â†’ `flag = false` |
| **é™æ€æ•°ç»„** | æ‰€æœ‰å…ƒç´ é‡ç½®ï¼Œé•¿åº¦ä¿æŒ | `delete arr` â†’ å…ƒç´ å˜ä¸º 0ï¼Œé•¿åº¦ä¸å˜ |
| **åŠ¨æ€æ•°ç»„** | é•¿åº¦å˜ä¸º 0 | `delete dynamicArr` â†’ `length = 0` |
| **ç»“æ„ä½“** | æ‰€æœ‰æˆå‘˜é‡ç½®ï¼ˆé™¤ mappingï¼‰ | `delete struct` â†’ æˆå‘˜é‡ç½® |
| **æ˜ å°„æ•´ä½“** | æ— æ•ˆæœ | `delete mapping` â†’ æ— ä½œç”¨ |
| **æ˜ å°„å…ƒç´ ** | åˆ é™¤æŒ‡å®šé”®çš„å€¼ | `delete mapping[key]` â†’ å€¼é‡ç½® |

### ç‰¹æ®Šæƒ…å†µ

#### æ•°ç»„å…ƒç´ åˆ é™¤
```solidity
uint[] arr = [1, 2, 3, 4];
delete arr[1];  // arr = [1, 0, 3, 4] - ç•™ä¸‹"ç©ºæ´"ï¼Œé•¿åº¦ä¸å˜
```

#### å¼•ç”¨ç±»å‹æ³¨æ„äº‹é¡¹
```solidity
// å¯¹äº storage ä¸­çš„å¼•ç”¨ç±»å‹
// delete æ˜¯é‡æ–°èµ‹å€¼ä¸ºæ–°çš„åˆå§‹å¯¹è±¡ï¼Œè€Œéä¿®æ”¹åŸå¯¹è±¡
```

---

## ğŸ”¹ å®æˆ˜ç¤ºä¾‹

```solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

contract OperatorDemo {
    uint256 public x = 10;
    uint8 public y = 255;
    bool public flag = true;
    
    uint[] public arr;
    struct Person { 
        uint age; 
        bool isActive; 
    }
    Person public person;
    mapping(address => uint) public balances;

    constructor() {
        // åˆå§‹åŒ–æ•°ç»„
        arr.push(1);
        arr.push(2);
        arr.push(3);
        
        // åˆå§‹åŒ–ç»“æ„ä½“
        person.age = 25;
        person.isActive = true;
        
        // åˆå§‹åŒ–æ˜ å°„
        balances[msg.sender] = 100;
    }

    function testBasicOperators() public {
        // åŸºç¡€è¿ç®—
        uint8  a = 5;
        int32  b = 10;
        int32  result = a + b;  // ç»“æœä¸º int32 ç±»å‹
        
        // ä¸‰å…ƒè¿ç®—ç¬¦
        uint256 max = (x > 20) ? x : 20;
        
        // æ¯”è¾ƒè¿ç®—
        bool isEqual = (a == 5);  // ç»“æœä¸º bool
    }

    function testCompoundOperators() public {
        // å¤åˆèµ‹å€¼
        x += 5;   // x = 15
        x *= 2;   // x = 30
        x /= 3;   // x = 10
        
        // å¢å‡è¿ç®—ç¬¦
        uint256 oldY = y++;  // oldY = 255, y = 0 (æº¢å‡º)
        uint256 newY = ++y;  // newY = 1, y = 1
    }

    function testDeleteOperator() public {
        // åˆ é™¤åŸºæœ¬ç±»å‹
        delete x;         // x = 0
        delete flag;      // flag = false
        
        // åˆ é™¤ç»“æ„ä½“
        delete person;    // person.age = 0, person.isActive = false
        
        // åˆ é™¤æ•°ç»„å…ƒç´ ï¼ˆç•™ä¸‹ç©ºæ´ï¼‰
        delete arr[1];    // arr = [1, 0, 3]
        
        // åˆ é™¤æ•´ä¸ªåŠ¨æ€æ•°ç»„
        delete arr;       // arr.length = 0
        
        // åˆ é™¤æ˜ å°„å…ƒç´ 
        delete balances[msg.sender];  // balances[msg.sender] = 0
    }

    function getArrayElement(uint index) public view returns (uint) {
        require(index < arr.length, "Index out of bounds");
        return arr[index];
    }
    
    function getBalance(address addr) public view returns (uint) {
        return balances[addr];
    }
}
```

---

## ğŸ’¡ æœ€ä½³å®è·µ

1. **ç±»å‹å®‰å…¨**ï¼šæ˜ç¡®å˜é‡ç±»å‹ï¼Œé¿å…éšå¼è½¬æ¢é™·é˜±
2. **æº¢å‡ºæ£€æŸ¥**ï¼šä½¿ç”¨ Solidity 0.8+ çš„å†…ç½®æº¢å‡ºæ£€æŸ¥
3. **ä¸‰å…ƒè¿ç®—ç¬¦**ï¼šè°¨æ…ä½¿ç”¨ï¼Œç¡®ä¿ä¸¤ä¸ªåˆ†æ”¯ç±»å‹å…¼å®¹
4. **delete æ“ä½œ**ï¼šç†è§£ä¸åŒç±»å‹çš„åˆ é™¤è¡Œä¸ºå·®å¼‚
5. **æ•°ç»„æ“ä½œ**ï¼šåˆ é™¤æ•°ç»„å…ƒç´ åæ³¨æ„"ç©ºæ´"é—®é¢˜

---

*å‚è€ƒæ–‡æ¡£ï¼š[Solidity å®˜æ–¹æ–‡æ¡£ - è¿ç®—ç¬¦](https://docs.soliditylang.org/zh-cn/latest/types.html)*